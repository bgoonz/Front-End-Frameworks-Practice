$(() => {
  // Enable hover effect on the style switcher
  const toggleHover = (e) => {
    $(e.currentTarget).toggleClass("hover");
  };

  $("#switcher").hover(toggleHover, toggleHover);

  // Allow the style switcher to expand and collapse.
  const toggleSwitcher = (e) => {
    if (!$(e.target).is("button")) {
      $(e.currentTarget).children("button").toggleClass("hidden");
    }
  };

  $("#switcher")
    .on("click", toggleSwitcher)
    // Simulate a click so we start in a collaped state.
    .click();

  // The setBodyClass() function changes the page style.
  // The style switcher state is also updated.
  const setBodyClass = (className) => {
    $("body").removeClass().addClass(className);

    $("#switcher button").removeClass("selected");
    $(`#switcher-${className}`).addClass("selected");
    $("#switcher").off("click", toggleSwitcher);

    if (className == "default") {
      $("#switcher").on("click", toggleSwitcher);
    }
  };

  // Begin with the switcher-default button "selected"
  $("#switcher-default").addClass("selected");

  // Map key codes to their corresponding buttons to click
  const triggers = {
    D: "default",
    N: "narrow",
    L: "large",
  };

  // Call setBodyClass() when a button is clicked.
  $("#switcher").click((e) => {
    if ($(e.target).is("button")) {
      setBodyClass(e.target.id.split("-")[1]);
    }
  });

  // Call setBodyClass() when a key is pressed.
  $(document).keyup((e) => {
    const key = String.fromCharCode(e.which);

    if (key in triggers) {
      setBodyClass(triggers[key]);
    }
  });
});
